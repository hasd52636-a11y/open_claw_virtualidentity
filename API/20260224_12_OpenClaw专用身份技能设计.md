# OpenClawä¸“ç”¨èº«ä»½æŠ€èƒ½è®¾è®¡

## ğŸ¯ æŠ€èƒ½è®¾è®¡æ ‡å‡†

### SKILL.md æ ‡å‡†æ–‡æ¡£
```yaml
name: identity-generator
description: é€šè¿‡APIè¯·æ±‚ç”Ÿæˆè™šæ‹Ÿèº«ä»½ä¿¡æ¯ï¼Œæ”¯æŒå“ˆå¸ŒéªŒè¯
author: çº¢å­©å„¿å›¢é˜Ÿ
version: 1.0.0
homepage: https://github.com/your-org/identity-generator

metadata:
  clawdbot:
    emoji: "ğŸ†”"
    requires:
      env:
        - IDENTITY_API_KEY
        - IDENTITY_API_URL
      bins:
        - curl
    capabilities:
      - identity-generation
      - hash-verification
      - bulk-operations

# APIé…ç½®
api:
  base_url: "{{process.env.IDENTITY_API_URL}}"
  endpoints:
    generate: "/api/v1/identities/generate"
    bulk_generate: "/api/v1/identities/bulk-generate"
    verify: "/api/v1/verification/verify"

# å“ˆå¸ŒéªŒè¯é…ç½®
hash_verification:
  algorithm: "sha256"
  salt: "{{process.env.HASH_SALT}}"
  key_derivation: "hkdf"
```

## ğŸ”§ æŠ€èƒ½å®ç°ä»£ç 

### identity-generator.js
```javascript
const { tool } = require('@openclaw/core');

class IdentityGenerator {
  constructor() {
    this.apiKey = process.env.IDENTITY_API_KEY;
    this.apiUrl = process.env.IDENTITY_API_URL;
    this.hashSalt = process.env.HASH_SALT || 'default-salt';
  }

  // ç”Ÿæˆå•ä¸ªèº«ä»½
  async generateIdentity(options = {}) {
    const response = await this.makeRequest('/generate', {
      country: options.country || 'US',
      includeFinancial: options.includeFinancial || false,
      verificationMethod: options.verificationMethod || 'email'
    });

    // éªŒè¯å“ˆå¸Œ
    if (!await this.verifyHash(response.data, response.hash, response.signature)) {
      throw new Error('Hash verification failed');
    }

    return response.data;
  }

  // æ‰¹é‡ç”Ÿæˆ
  async generateIdentities(count, options = {}) {
    const response = await this.makeRequest('/bulk-generate', {
      count: count,
      ...options
    });

    // éªŒè¯æ¯ä¸ªèº«ä»½çš„å“ˆå¸Œ
    for (const item of response.data) {
      if (!await this.verifyHash(item.identity, item.hash, item.signature)) {
        throw new Error(`Hash verification failed for identity ${item.requestId}`);
      }
    }

    return response.data;
  }

  // APIè¯·æ±‚å°è£…
  async makeRequest(endpoint, data) {
    const url = `${this.apiUrl}${endpoint}`;
    
    const response = await fetch(url, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-API-Key': this.apiKey,
        'X-Request-ID': this.generateRequestId()
      },
      body: JSON.stringify(data)
    });

    if (!response.ok) {
      throw new Error(`API request failed: ${response.status}`);
    }

    return await response.json();
  }

  // å“ˆå¸ŒéªŒè¯
  async verifyHash(data, receivedHash, signature) {
    // è®¡ç®—æœŸæœ›å“ˆå¸Œ
    const expectedHash = this.calculateHash(data);
    
    if (expectedHash !== receivedHash) {
      return false;
    }

    // éªŒè¯ç­¾å
    const verificationKey = this.deriveKeyFromHash(receivedHash);
    const expectedSignature = this.calculateSignature(data, verificationKey);
    
    return expectedSignature === signature;
  }

  // è®¡ç®—å“ˆå¸Œ
  calculateHash(data) {
    const content = typeof data === 'string' ? data : JSON.stringify(data);
    return crypto.createHash('sha256').update(content + this.hashSalt).digest('hex');
  }

  // ä»å“ˆå¸Œæ´¾ç”Ÿå¯†é’¥
  deriveKeyFromHash(hash) {
    return crypto.createHmac('sha256', this.hashSalt)
                 .update(hash)
                 .digest('hex')
                 .substring(0, 32);
  }

  // è®¡ç®—ç­¾å
  calculateSignature(data, key) {
    const content = typeof data === 'string' ? data : JSON.stringify(data);
    return crypto.createHmac('sha256', key)
                 .update(content)
                 .digest('hex');
  }

  generateRequestId() {
    return `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }
}

// å¯¼å‡ºå·¥å…·
module.exports = {
  tools: {
    generate_identity: {
      description: 'Generate a virtual identity with hash verification',
      parameters: {
        country: { type: 'string', default: 'US' },
        includeFinancial: { type: 'boolean', default: false },
        verificationMethod: { type: 'string', enum: ['email', 'sms'], default: 'email' }
      },
      execute: async ({ country, includeFinancial, verificationMethod }) => {
        const generator = new IdentityGenerator();
        return await generator.generateIdentity({
          country,
          includeFinancial,
          verificationMethod
        });
      }
    },
    
    generate_identities: {
      description: 'Generate multiple virtual identities',
      parameters: {
        count: { type: 'number', minimum: 1, maximum: 100 },
        country: { type: 'string', default: 'US' },
        includeFinancial: { type: 'boolean', default: false }
      },
      execute: async ({ count, country, includeFinancial }) => {
        const generator = new IdentityGenerator();
        return await generator.generateIdentities(count, {
          country,
          includeFinancial
        });
      }
    }
  }
};
```

## ğŸŒ ç½‘ç«™ç«¯APIè®¾ç½®

### ç½‘ç«™APIè®¾è®¡ï¼ˆå•ç‹¬é˜è¿°ï¼‰

#### 1. APIç«¯ç‚¹è®¾è®¡
```javascript
// app.js - ç½‘ç«™APIæœåŠ¡å™¨
const express = require('express');
const crypto = require('crypto');
const app = express();

app.use(express.json());

// ç¯å¢ƒå˜é‡é…ç½®
const API_KEY = process.env.API_KEY || 'sk_default_key';
const HASH_SALT = process.env.HASH_SALT || 'default-salt';

// èº«ä»½ç”Ÿæˆç«¯ç‚¹
app.post('/api/v1/identities/generate', async (req, res) => {
  try {
    // éªŒè¯APIå¯†é’¥
    const apiKey = req.headers['x-api-key'];
    if (apiKey !== API_KEY) {
      return res.status(401).json({ error: 'Invalid API key' });
    }

    // ç”Ÿæˆèº«ä»½ä¿¡æ¯
    const identity = generateIdentity(req.body.country || 'US');
    
    // è®¡ç®—å“ˆå¸Œ
    const contentHash = calculateHash(identity);
    
    // ç”ŸæˆéªŒè¯å¯†é’¥
    const verificationKey = deriveKeyFromHash(contentHash);
    
    // ç”Ÿæˆç­¾å
    const signature = calculateSignature(identity, verificationKey);

    res.json({
      status: 'success',
      data: identity,
      hash: contentHash,
      signature: signature,
      requestId: req.headers['x-request-id'] || generateRequestId()
    });

  } catch (error) {
    res.status(500).json({
      error: 'Generation failed',
      message: error.message
    });
  }
});

// æ‰¹é‡ç”Ÿæˆç«¯ç‚¹
app.post('/api/v1/identities/bulk-generate', async (req, res) => {
  // ç±»ä¼¼çš„å®ç°ï¼Œæ”¯æŒæ‰¹é‡æ“ä½œ
});
```

#### 2. å“ˆå¸ŒéªŒè¯å‡½æ•°
```javascript
// hash-utils.js - å“ˆå¸Œç›¸å…³å‡½æ•°
function calculateHash(data) {
  const content = typeof data === 'string' ? data : JSON.stringify(data);
  return crypto.createHash('sha256')
               .update(content + HASH_SALT)
               .digest('hex');
}

function deriveKeyFromHash(hash) {
  return crypto.createHmac('sha256', HASH_SALT)
               .update(hash)
               .digest('hex')
               .substring(0, 32);
}

function calculateSignature(data, key) {
  const content = typeof data === 'string' ? data : JSON.stringify(data);
  return crypto.createHmac('sha256', key)
               .update(content)
               .digest('hex');
}
```

#### 3. èº«ä»½ç”Ÿæˆé€»è¾‘
```javascript
// identity-generator.js - èº«ä»½ç”Ÿæˆæ ¸å¿ƒ
function generateIdentity(country = 'US') {
  const countries = {
    US: {
      firstName: ['John', 'Jane', 'Robert', 'Mary'],
      lastName: ['Smith', 'Johnson', 'Williams', 'Brown'],
      phoneFormat: '+1-555-###-####',
      addressFormat: '{number} {street} {type}'
    },
    CN: {
      firstName: ['ä¼Ÿ', 'èŠ³', 'å¨œ', 'å¼º'],
      lastName: ['ç‹', 'æ', 'å¼ ', 'åˆ˜'],
      phoneFormat: '+86 138########',
      addressFormat: '{province}{city}{district}{street}'
    }
  };

  const config = countries[country] || countries.US;
  
  return {
    personal: {
      firstName: randomChoice(config.firstName),
      lastName: randomChoice(config.lastName),
      fullName: `${randomChoice(config.firstName)} ${randomChoice(config.lastName)}`,
      gender: Math.random() > 0.5 ? 'male' : 'female',
      birthDate: generateBirthDate(),
      age: randomInt(18, 65)
    },
    contact: {
      email: generateEmail(),
      phone: generatePhoneNumber(config.phoneFormat),
      address: generateAddress(config.addressFormat)
    },
    metadata: {
      country: country,
      generatedAt: new Date().toISOString(),
      isTestData: true
    }
  };
}
```

## ğŸ”„ äº¤äº’é€šä¿¡æµç¨‹

### 1. OpenClawå‘èµ·è¯·æ±‚
```javascript
// OpenClawæŠ€èƒ½è°ƒç”¨æµç¨‹
const identity = await tools.generate_identity({
  country: 'US',
  includeFinancial: true,
  verificationMethod: 'email'
});
```

### 2. ç½‘ç«™å¤„ç†è¯·æ±‚
```http
POST /api/v1/identities/generate
Content-Type: application/json
X-API-Key: sk_actual_api_key_here
X-Request-ID: req_1234567890

{
  "country": "US",
  "includeFinancial": true,
  "verificationMethod": "email"
}
```

### 3. ç½‘ç«™å“åº”
```json
{
  "status": "success",
  "data": {
    "personal": {
      "firstName": "John",
      "lastName": "Smith",
      "fullName": "John Smith",
      "gender": "male",
      "birthDate": "1985-07-15",
      "age": 38
    },
    "contact": {
      "email": "john.smith@example.com",
      "phone": "+1-555-012-3456",
      "address": "123 Main St, New York, NY"
    }
  },
  "hash": "a1b2c3d4e5f6...",
  "signature": "signature_value_here",
  "requestId": "req_1234567890"
}
```

### 4. OpenClawéªŒè¯å“åº”
```javascript
// è‡ªåŠ¨éªŒè¯å“ˆå¸Œå’Œç­¾å
if (hash !== calculateHash(data)) {
  throw new Error('Data integrity check failed');
}

if (signature !== calculateSignature(data, deriveKeyFromHash(hash))) {
  throw new Error('Signature verification failed');
}
```

## ğŸ›¡ï¸ å®‰å…¨é…ç½®

### OpenClawç¯å¢ƒå˜é‡
```bash
# .env æ–‡ä»¶
IDENTITY_API_KEY=sk_your_actual_api_key
IDENTITY_API_URL=https://your-api.com/api/v1
HASH_SALT=your-super-secret-salt-value
```

### ç½‘ç«™ç¯å¢ƒå˜é‡
```bash
# ç½‘ç«™ .env æ–‡ä»¶
API_KEY=sk_your_actual_api_key
HASH_SALT=your-super-secret-salt-value
PORT=3000
NODE_ENV=production
```

## ğŸš€ éƒ¨ç½²å’Œæµ‹è¯•

### OpenClawæŠ€èƒ½å®‰è£…
```bash
# å®‰è£…æŠ€èƒ½
clawdhub install identity-generator

# é…ç½®ç¯å¢ƒå˜é‡
export IDENTITY_API_KEY=sk_your_key
export IDENTITY_API_URL=https://your-api.com
export HASH_SALT=your-secret-salt
```

### ç½‘ç«™éƒ¨ç½²
```bash
# å®‰è£…ä¾èµ–
npm install express crypto

# å¯åŠ¨æœåŠ¡å™¨
node app.js
```

### æµ‹è¯•å‘½ä»¤
```bash
# æµ‹è¯•API
curl -X POST https://your-api.com/api/v1/identities/generate \
  -H "Content-Type: application/json" \
  -H "X-API-Key: sk_your_key" \
  -d '{"country": "US"}'
```

## ğŸ“‹ å®Œæ•´å·¥ä½œæµç¨‹

1. **æŠ€èƒ½é…ç½®** - è®¾ç½®APIå¯†é’¥å’ŒURL
2. **è¯·æ±‚å‘èµ·** - OpenClawè°ƒç”¨ç”ŸæˆåŠŸèƒ½
3. **APIå¤„ç†** - ç½‘ç«™éªŒè¯å¹¶ç”Ÿæˆèº«ä»½
4. **å“ˆå¸Œè®¡ç®—** - ç½‘ç«™è®¡ç®—å†…å®¹å“ˆå¸Œå’Œç­¾å
5. **å“åº”è¿”å›** - è¿”å›èº«ä»½æ•°æ®+å“ˆå¸Œ+ç­¾å
6. **éªŒè¯éªŒè¯** - OpenClawéªŒè¯æ•°æ®å®Œæ•´æ€§
7. **ç»“æœä½¿ç”¨** - ä½¿ç”¨éªŒè¯é€šè¿‡çš„èº«ä»½æ•°æ®

**å¤§ç‹ï¼Œè¿™æ ·è®¾è®¡å°±å®Œæ•´äº†ï¼** ç½‘ç«™æä¾›æ ‡å‡†çš„APIæ¥å£ï¼ŒOpenClawé€šè¿‡ä¸“ç”¨æŠ€èƒ½è°ƒç”¨ï¼ŒåŒæ–¹é€šè¿‡å“ˆå¸ŒéªŒè¯ç¡®ä¿æ•°æ®å®‰å…¨ã€‚